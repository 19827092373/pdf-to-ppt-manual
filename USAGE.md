# 使用说明

## 快速开始

### 1. 安装依赖

首先确保已安装Python 3.7或更高版本，然后安装Python依赖：

```bash
pip install -r requirements.txt
```

### 2. 安装系统依赖（Poppler）

#### Windows系统
1. 访问 https://github.com/oschwartz10612/poppler-windows/releases/
2. 下载最新版本的zip文件（例如：Release-23.11.0-0.zip）
3. 解压到任意目录（例如：`C:\poppler`）
4. 将 `poppler-xx.xx.x\Library\bin` 目录添加到系统PATH环境变量
   - 右键"此电脑" -> 属性 -> 高级系统设置 -> 环境变量
   - 在"系统变量"中找到Path，点击编辑
   - 添加poppler的bin目录路径
   - 重启命令行窗口

#### Linux系统
```bash
sudo apt-get install poppler-utils
```

#### macOS系统
```bash
brew install poppler
```

### 3. 启动应用

#### Windows系统
双击运行 `run.bat` 文件，或在命令行中执行：
```bash
python app.py
```

#### Linux/macOS系统
```bash
python app.py
```

### 4. 访问应用

打开浏览器，访问：`http://localhost:5001`

**注意**：如果端口5001也被占用，可以：
- 使用 `run_port.bat` 脚本自定义端口
- 或在命令行中运行：`python app.py 5002`（使用5002端口，或其他可用端口）

## 使用步骤

### 步骤1：上传PDF文件
1. 点击上传区域或拖拽PDF文件到上传区域
2. 等待PDF处理完成（系统会将PDF转换为图片）

### 步骤2：选择页面
1. 在左侧页面列表中点击要处理的页面
2. 页面大图会显示在中间区域

### 步骤3：选择题目
1. **绘制矩形框**：在图片上点击并拖拽，绘制一个矩形框选择题目
2. **调整矩形框**：
   - **拖拽移动**：点击矩形框内部并拖拽，可以移动矩形框位置
   - **缩放调整**：点击矩形框的边缘或角落，可以调整矩形框大小
   - **双击选择**：双击矩形框可以选中它（选中的矩形框会变成蓝色）

### 步骤4：管理选择
- **查看已选择题目**：右侧面板显示所有已选择的题目
- **选择矩形框**：点击右侧列表中的题目，可以选中对应的矩形框
- **删除题目**：点击右侧列表中的删除按钮，可以删除该题目
- **清除当前页面**：点击"清除当前选择"按钮，清除当前页面的所有选择

### 步骤5：处理所有页面
重复步骤2-4，处理PDF的所有页面，选择所有需要转换的题目。

### 步骤6：生成PPT
1. 确认所有题目都已选择完成
2. 点击右侧的"生成PPT"按钮
3. 等待处理完成（系统会裁剪图片并生成PPT）
4. PPT文件会自动下载

## 操作技巧

### 矩形框操作
- **精确选择**：可以先绘制一个大致范围的矩形框，然后通过拖拽和缩放精确调整
- **多题目选择**：在同一页面上可以绘制多个矩形框，选择多道题目
- **快速删除**：选中矩形框后，点击"删除选中框"按钮可以快速删除

### 图片布局说明
- 生成的PPT中，每道题目占据一页
- 题目图片会自动放置在PPT页面的左上角
- 图片尺寸会自动调整，确保不超过页面的一半区域
- 图片会保持原始宽高比

## 常见问题

### Q: 上传PDF后看不到图片？
A: 请检查：
1. PDF文件是否损坏
2. 是否安装了poppler工具
3. 浏览器控制台是否有错误信息

### Q: 矩形框无法调整？
A: 请确保：
1. 已经绘制了矩形框
2. 双击矩形框选中它（选中的矩形框会变成蓝色）
3. 鼠标移动到矩形框边缘或角落时，光标会变成调整形状

### Q: 生成的PPT图片太小或太大？
A: 系统会自动调整图片尺寸，确保不超过页面一半。如果图片太小，可能是因为：
1. 选择的矩形框区域太小
2. 原始PDF分辨率较低

建议：选择题目时，尽量包含完整的题目内容，包括题目编号和所有文字。

### Q: 可以批量处理多个PDF吗？
A: 当前版本不支持批量处理，需要逐个处理PDF文件。

### Q: 支持哪些PDF格式？
A: 支持标准的PDF格式。如果PDF是扫描件（图片PDF），也可以正常处理。

## 技术说明

- **PDF转图片DPI**：200 DPI（保证清晰度的同时控制文件大小）
- **PPT尺寸**：10英寸 × 7.5英寸（16:9比例）
- **图片最大尺寸**：5英寸 × 3.75英寸（页面一半）
- **支持的文件大小**：最大50MB

## 注意事项

1. **文件清理**：临时文件会保存在`temp`目录，生成的PPT保存在`output`目录，请定期清理
2. **浏览器兼容性**：建议使用Chrome、Firefox、Edge等现代浏览器
3. **性能建议**：处理大型PDF文件时，可能需要较长时间，请耐心等待

## 反馈与支持

如有问题或建议，请查看项目计划文档（PROJECT_PLAN.md）了解详细设计。

