# 打包成exe文件说明

## 📦 打包方式

### 方式一：使用批处理脚本（推荐，最简单）

1. **运行打包脚本**
   ```bash
   打包成exe完整版.bat
   ```
   或双击 `打包成exe完整版.bat` 文件

2. **等待打包完成**
   - 打包过程需要5-10分钟
   - 会自动安装PyInstaller（如果未安装）
   - 会自动清理旧文件

3. **获取exe文件**
   - 打包完成后，exe文件在 `dist\PDF习题拆分工具.exe`
   - 文件大小约 80-150 MB

### 方式二：使用spec文件（高级）

1. **安装PyInstaller**
   ```bash
   pip install pyinstaller
   ```

2. **使用spec文件打包**
   ```bash
   pyinstaller PDF习题拆分工具.spec
   ```

3. **获取exe文件**
   - exe文件在 `dist\PDF习题拆分工具.exe`

### 方式三：手动打包（自定义）

```bash
pyinstaller --name="PDF习题拆分工具" ^
    --onefile ^
    --noconsole ^
    --add-data "templates;templates" ^
    --add-data "static;static" ^
    --add-data "utils;utils" ^
    --hidden-import=flask ^
    --hidden-import=werkzeug ^
    --hidden-import=jinja2 ^
    --hidden-import=pdf2image ^
    --hidden-import=PIL ^
    --hidden-import=pptx ^
    --hidden-import=fitz ^
    --hidden-import=PyMuPDF ^
    app.py
```

---

## ✅ 打包前检查清单

- [x] Python已安装（3.7+）
- [x] 所有依赖已安装：`pip install -r requirements.txt`
- [x] 项目文件完整（app.py, templates, static, utils）
- [x] 测试应用可以正常运行：`python app.py`

---

## 📋 打包参数说明

| 参数 | 说明 |
|------|------|
| `--onefile` | 打包成单个exe文件 |
| `--noconsole` | 不显示控制台窗口（GUI模式） |
| `--add-data` | 添加数据文件（模板、静态文件等） |
| `--hidden-import` | 显式导入隐藏的模块 |
| `--name` | 指定exe文件名 |

---

## 🚀 使用打包后的exe

### 运行exe

1. **双击运行**
   - 双击 `PDF习题拆分工具.exe`
   - 首次运行可能需要等待几秒

2. **访问应用**
   - 程序会自动打开浏览器
   - 如果没有自动打开，手动访问：`http://localhost:5001`

3. **关闭程序**
   - 关闭浏览器窗口
   - 或在任务管理器中结束进程

### 分享给他人

1. **发送exe文件**
   - 将 `dist\PDF习题拆分工具.exe` 发送给他人
   - 文件较大（80-150MB），建议使用网盘分享

2. **使用说明**
   - 对方双击exe即可使用
   - 无需安装Python或任何依赖
   - 首次运行可能较慢（正常现象）

---

## ⚠️ 常见问题

### Q: 打包失败，提示缺少模块？

**解决方法**：
1. 确保所有依赖已安装：`pip install -r requirements.txt`
2. 检查 `--hidden-import` 参数是否包含所有需要的模块
3. 查看错误信息，添加缺失的模块到 `--hidden-import`

### Q: exe文件太大？

**原因**：
- 包含了Python解释器和所有依赖库
- 这是正常现象，单个exe文件通常80-150MB

**解决方法**：
- 使用 `--onedir` 代替 `--onefile`（会生成文件夹，但文件更小）
- 或使用便携版方案（需要Python环境）

### Q: 杀毒软件误报？

**原因**：
- PyInstaller打包的exe可能被误报为病毒
- 这是误报，可以安全使用

**解决方法**：
1. 添加exe文件到杀毒软件白名单
2. 或使用代码签名证书（需要购买）

### Q: exe运行后无法访问？

**检查**：
1. 确认exe正在运行（任务管理器）
2. 检查端口5001是否被占用
3. 尝试访问：`http://localhost:5001`
4. 查看防火墙是否阻止

### Q: 首次运行很慢？

**原因**：
- exe需要解压临时文件
- 这是正常现象

**解决方法**：
- 首次运行需要等待10-30秒
- 后续运行会快一些

### Q: 文件上传失败？

**检查**：
1. 确保有写入权限
2. 检查磁盘空间
3. 文件大小不超过50MB（代码中限制）

---

## 🔧 优化建议

### 1. 减小文件大小

- 使用 `--onedir` 模式（生成文件夹而非单个exe）
- 排除不需要的模块
- 使用UPX压缩（已启用）

### 2. 提高启动速度

- 使用 `--onedir` 模式
- 减少隐藏导入的模块
- 优化代码

### 3. 添加图标

创建 `icon.ico` 文件，然后添加参数：
```bash
--icon=icon.ico
```

### 4. 代码签名（可选）

如果需要代码签名：
1. 购买代码签名证书
2. 使用signtool签名exe文件

---

## 📝 打包后的文件结构

```
dist/
└── PDF习题拆分工具.exe  (80-150 MB)
```

**注意**：`--onefile` 模式只生成一个exe文件，所有内容都打包在其中。

---

## 🎯 推荐方案

### 个人使用/小范围分享
- ✅ 使用 `打包成exe完整版.bat`
- ✅ 单个exe文件，方便分享
- ✅ 用户无需安装任何东西

### 团队内部分享
- ✅ 使用便携版（需要Python环境）
- ✅ 文件更小，更新方便

### 正式发布
- ✅ 使用Inno Setup创建安装程序
- ✅ 更专业，用户体验更好

---

## 📞 需要帮助？

如果打包遇到问题：
1. 查看错误信息
2. 检查依赖是否完整
3. 查看PyInstaller文档：https://pyinstaller.org/
4. 在GitHub上提交Issue

---

**祝你打包顺利！** 🚀

